(function(n,t,i){i.mvvm||(i.mvvm={});i.mvvm.Model=i.data.Model.extend({init:function(){i.data.Model.fn.init.call(this)}});i.mvvm.View=i.Class.extend({init:function(n,i){var r=this;r.viewModel=i;t(document).ready(t.proxy(r._ready,r,t(n),i))},_ready:function(n,r){t("[data-role='pageload']").remove();i.ui.progress(n,!0);this.ready(n,r)},ready:function(n,t){i.bind(n,t);i.ui.progress(n,!1)}});i.mvvm.ViewModel=i.data.ObservableObject.extend({init:function(){i.data.ObservableObject.fn.init.call(this,this)}});i.mvvm.DialogViewModel=i.mvvm.ViewModel.extend({init:function(){ViewModel.fn.init.call(this)},triggerClose:function(n,t){this.trigger("close",{userTriggered:n,dialogResult:t})}});i.mvvm.DialogService=i.Class.extend({init:function(n){this.views=n},hasDialogOpen:!1,views:{},open:function(n,r){var o,c;if(!n)throw"Required [view] is missing.";var e=new t.Deferred,s=t("<div class='k-custom-dialog' />").kendoDialog({actions:r.actions,close:function(){this.destroy()}}),f=this.views[n],l=f.id,a=t(l).html(),u=s.data("kendoDialog"),h=t(i.template(a)(r.viewModel));if(u.content(h),f.cssClass){let n=u.element.closest(".k-dialog");t(n).addClass(f.cssClass)}if(f.cssContentClass){let n=s;t(n).addClass(f.cssContentClass)}return u.bind("close",function(n){e.state()!=="resolved"&&e.resolve({userTriggered:n.userTriggered,dialogResult:null})}),r.viewModel&&(i.bind(h,r.viewModel),r.viewModel instanceof i.mvvm.DialogViewModel&&r.viewModel.bind("close",function(n){e.resolve({userTriggered:n.userTriggered,dialogResult:n.dialogResult});u.close()})),r.title&&u.title(r.title),u.open(),this.hasDialogOpen=!0,r.opened&&t.proxy(r.opened(),this),o=e.promise(),c=this,o.always(function(){c.hasDialogOpen=!1}),o}});n.Model=i.mvvm.Model;n.ViewModel=i.mvvm.ViewModel;n.View=i.mvvm.View})(window,window.kendo.jQuery,window.kendo),function(n,t,i){t.data.ObservableGridColumn=t.data.ObservableObject.extend({init:function(n){t.data.ObservableObject.fn.init.call(this,this);this.set("field",n)},expandedField:i,field:i,title:i,hidden:!1,format:i,filterable:!1,template:i,width:150});t.data.binders.widget.grid.columns=t.data.Binder.extend({init:function(i,r,u){t.data.Binder.fn.init.call(this,i.element[0],r,u);this._options();this._columnResize=n.proxy(this.columnResize,this);this._columnShow=n.proxy(this.columnShow,this);this._columnHide=n.proxy(this.columnHide,this);this._columnReorder=n.proxy(this.columnReorder,this);this._columnChange=n.proxy(this.columnChange,this);i.bind("columnResize",this._columnResize);i.bind("columnShow",this._columnShow);i.bind("columnHide",this._columnHide);i.bind("columnReorder",this._columnReorder);this.widget=i;this._initChange=!1},change:function(i,r){var f;this._initChange=!0;var u=this,o=n(u.element).data("kendoGrid"),e=u.bindings.columns;if(e.source.columns){switch(r){case"reorder":u.columnFill&&u._moveColumnFill()}f=u._cloneArray(o.columns);e.get()instanceof t.data.ObservableArray&&(f=new t.data.ObservableArray(f));r==="reorder"&&u._moveArrayItem(f,i.oldIndex,i.newIndex);this.columnFill&&u._removeColumnFill(f);e.source.set("columns",f)}this._initChange=!1},columnChange:function(n){n.action==="itemchange"&&this.change(n)},columnFill:!1,columnResize:function(n){this.change(n)},columnShow:function(n){this.change(n)},columnHide:function(n){this.change(n)},columnReorder:function(n){this.change(n,"reorder")},destroy:function(){this.widget.unbind("columnResize",this._columnResize);this.widget.unbind("columnShow",this._columnShow);this.widget.unbind("columnHide",this._columnHide);this.widget.unbind("columnReorder",this._columnReorder)},refresh:function(){if(!this._initChange){var r=n(this.element).data("kendoGrid"),e=this.bindings.columns,u=e.get(),f=u instanceof t.data.ObservableArray?u.toJSON():u;this.columnFill&&this._addColumnFill(f);r._refreshOptions!==i&&r._refreshOptions===!1&&(r._refreshOptions=!0,r.setOptions({columns:f}),r._refreshOptions=!1);r._refreshOptions===i&&(r.setOptions({columns:f}),r._refreshOptions=!1)}},_cloneArray:function(t){var i=[];return n.each(t,function(n,t){i.push({field:t.field,hidden:t.hidden,template:t.template,filterable:t.filterable,format:t.format,width:t.width,title:t.title})}),i},_moveArrayItem:function(n,t,i){var r=n[t];n.splice(t,1);n.splice(i,0,r)},_moveColumnFill:function(){var t=n(this.element).data("kendoGrid"),i;n.each(t.columns,function(n,t){t.field===""&&(i=t)});setTimeout(function(){t.reorderColumn(t.columns.length-1,i)},0)},_options:function(){this.columnFill=n(this.element).data("columnFill")===!0},_addColumnFill:function(n){var r=new t.data.ObservableGridColumn("");r.width=i;n.push(r.toJSON())},_removeColumnFill:function(t){return n.each(t,function(n,i){if(i.field==="")return t.splice(n,1),!1}),!0}})}(window.kendo.jQuery,window.kendo),function(n,t,i){var r="change",f="dataBound",u="itemChange",e="save",o="data-gs-x",s="data-gs-y",h="data-gs-width",c="data-gs-height",l=t.ui.Widget.extend({init:function(n,i){var r=this;t.ui.Widget.fn.init.call(r,n,i);r._templates();r._widgetList();r._gridstack();r._dataSource();t.notify(r)},events:[r,"dataBinding",f,"drag",u,e],options:{name:"Dashboard",autoBind:!0,template:"",widgetList:[],dataSizeXField:"",dataSizeYField:"",dataRowField:"",dataColField:"",widgetFailedTemplate:"",widgetMisconfiguredTemplate:""},_templates:function(){var n=this.options;this.template=t.template(n.template||"<div class='grid-stack grid-stack-8'><\/div>");this.widgetFailedTemplate=t.template(n.widgetFailedTemplate||"");this.widgetMisconfiguredTemplate=t.template(n.widgetMisconfiguredTemplate||"")},_dataSource:function(){var i=this;i.dataSource&&i._refreshHandler?i.dataSource.unbind(r,i._refreshHandler):i._refreshHandler=n.proxy(i._refresh,i);i.dataSource=t.data.DataSource.create(i.options.dataSource);i.dataSource.bind(r,i._refreshHandler);i.options.autoBind&&i.dataSource.fetch()},addWidget:function(n){var t=this.nextPosition(n.sizeX,n.sizeY);if(t)n.positionX=t.col,n.positionY=t.row,n.sizeX=t.size_x,n.sizeY=t.size_y;else return!1;return this.dataSource.add(n),!0},dataItem:function(n){var i=n.attr(t.attr("uid"));return this.dataSource.getByUid(i)},edit:function(){var t=this,i;n(t.element).addClass("k-state-edit");i=t.items();n.each(i,function(t,i){n(i).addClass("k-state-edit")});t._gridstack.enable()},endEdit:function(){var t=this,i;n(t.element).removeClass("k-state-edit");i=t.items();n.each(i,function(i,r){n(r).removeClass("k-state-edit");n(t.element).hasClass("k-state-ready")&&!n(t.element).hasClass("k-state-edit")&&n(t.element).removeClass("k-state-ready")});t._gridstack.disable()},items:function(){return n(this.element).find(".k-dashboard-widget")},nextPosition:function(n,t){var i=this._gridstack.willItFit(0,0,n,t,!0);return i?{positionX:i.col,positionY:i.row,sizeX:i.size_x,sizeY:i.size_y}:!1},refresh:function(){this._refresh({action:i})},refreshWidget:function(n){var t=this;t._refreshWidget(n).done(function(i){t.trigger(u,{item:i,data:n})})},save:function(){var t=this,i=t.items();n.each(i,function(t,i){var r=n(i).data("widget");r.positionX=parseInt(n(i).attr(o))+1;r.positionY=parseInt(n(i).attr(s))+1;r.sizeX=parseInt(n(i).attr(h));r.sizeY=parseInt(n(i).attr(c))});t.trigger(e)},setDataSource:function(n){this.options.dataSource=n;this._dataSource()},setWidgetState:function(n,t,i){var r=this._getWidget(n);switch(t){case"normal":r.removeClass("k-state-failed");r.removeClass("k-state-misconfigured");r.addClass("k-state-normal");break;case"misconfigured":r.removeClass("k-state-normal");r.removeClass("k-state-failed");r.addClass("k-state-misconfigured");break;case"error":r.removeClass("k-state-normal");r.removeClass("k-state-misconfigured");r.addClass("k-state-failed");console.log(i)}},widget:function(n){return this._getWidget(n)},_addWidget:function(i){var u=this,r=u.widgetList.find(function(n){return i.widget===n.name}),e,o,f;if(r||(r={name:i.widget}),r){e=n(u.element).hasClass("k-state-edit");o=u._renderItem(r.name,r.title,r.content,r.edit,i,r.commands,r.popout);f=i.positionX&&i.positionY?n(u._gridstack.addWidget(o,{x:i.positionX-1,y:i.positionY-1,width:i.sizeX,height:i.sizeY,noResize:!e,noMove:!e})):n(u._gridstack.addWidget(o,{x:0,y:0,width:i.sizeX,height:i.sizeY,autoPosition:!0,noResize:!e,noMove:!e}));f.data("widget",i);e&&f.addClass("k-state-edit");r.cssClass&&n(f).addClass(r.cssClass);n(f).addClass("k-state-ready");n(f).find(".k-dashboard-widget-header .k-dashboard-widget-command.remove").on("click",function(){u.dataSource.remove(i)});n(f).find(".k-dashboard-widget-header .k-dashboard-widget-command.refresh").on("click",function(){i.refresh&&r.content.template?i.refresh():u.refreshWidget(i)});n(f).find(".k-dashboard-widget-header .k-dashboard-widget-command.expand[title='Popout']").on("click",function(){u._popoutDataItem(i,r.content,r.popout)});return r.content&&!r.content.template?u._renderAjax(i,f,r.content):(r.content||u.setWidgetState(i,"error",t.format("Widget '{0}' is not recognized.",r.name)),n.Deferred().resolve(f).promise())}},_getWidget:function(t){var i;return(n.each(this.items(),function(r,u){if(n(u).data("uid")==t.uid)return i=n(u),!1}),!i)?null:i},_getWidgetBody:function(n){return n.find(".k-dashboard-widget-body")},_gridstack:function(){var t=this,r=t.template({}),i=n(r);n(t.element).html(i);t._gridstack=GridStack.init({disableOneColumnMode:!0,float:!0,cellHeight:100,maxRow:8,maxCol:8,column:8,row:8,verticalMargin:0,handleClass:"k-dashboard-widget-header"},n(i));t._gridstack.disable();t._gridstack.on("dragstart",n.proxy(t._gridstack_drag,t));t._gridstack.on("dragstop",n.proxy(t._gridstack_drag,t));t._gridstack.on("resizestart",n.proxy(t._gridstack_resize,t));t._gridstack.on("resizestop",n.proxy(t._gridstack_resize,t))},_gridstack_drag:function(t,i){var u=n(i.element),f=this.dataItem(u);this.trigger(r,{action:"drag",widget:u.eq(0),data:f})},_gridstack_resize:function(t,i){var u=n(i.element),f=this.dataItem(u);this.trigger(r,{action:"resize",item:u.eq(0),data:f})},_popoutDataItem:function(i,r,u){var s=this,h=u.template?t.template(n("#"+u.template).html()):t.template(n("#"+r.template).html()),c=h(i),o=n("<div><\/div>"),l=this._popoutOptions(o,i,u),e=o.kendoWindow(l).data("kendoWindow");n(e.wrapper).addClass("dashboard-popout");u.cssClass&&n(e.wrapper).addClass(u.cssClass);e.content(c);u.appendTo||e.center();s.bind(f,function(){e.close()});e.open()},_popoutOptions:function(n,i,r){var f=this,u={title:i.widget,modal:!1,animation:{close:!1},open:function(){t.bind(n,i);f.trigger("popoutOpen",{modal:u.modal,dataItem:i})},close:function(){this.destroy();f.trigger("popoutClose",{modal:u.modal,dataItem:i})}},e;return r.appendTo==null?(u.modal=!0,u.resizable=!0,u.draggable=!0,u.actions=["Maximize","Close"],r.width&&(u.width=r.width),r.height&&(u.height=r.height)):r.appendTo&&(e="calc(100% - 24px)",u.scrollable=!1,u.resizable=!1,u.draggable=!1,u.appendTo=r.appendTo,u.width=e,u.actions=["Close"]),u},_refresh:function(t){var r=this;switch(t.action){case i:r._gridstack.removeAll();r.trigger(f);n.each(r.dataSource!==null?r.dataSource.view():[],function(n,t){r._addWidget(t).done(function(n){r.trigger(u,{item:n.eq(0),data:t})})});break;case"add":n.each(t.items,function(n,t){r._addWidget(t).done(function(n){r.trigger(u,{item:n.eq(0),data:t})})});break;case"remove":n.each(t.items,function(n,t){var i=r._getWidget(t);r.trigger(u,{item:i.eq(0),data:t});r._removeWidget(t)})}},_refreshWidget:function(t){var i=this,r=i._getWidget(t),u=i.widgetList.find(function(n){return t.widget===n.name});return u.content.template?n.Deferred().resolve(r).promise():i._renderAjax(t,r,u.content)},_removeWidget:function(i){var u=this,r;return n.each(this.items(),function(f,e){var o=n(e).data("widget");if(i===o)return t.unbind(e),u._gridstack.removeWidget(n(e)),r=e,!1}),n(r)},_renderItem:function(i,r,u,f,e,o,s){var h="";return h+="<div class='k-dashboard-widget k-state-normal grid-stack-item' data-uid='#:uid#'>",h+="    <div class='k-dashboard-widget-content grid-stack-item-content'>",h+="        <div class='k-dashboard-widget-header clearfix'>",h+="            <span class='pull-left'>",h+=r&&r.template?t.template(n("#"+r.template).html())(e):r&&r.text?r.text:i,h+="            <\/span>",h+="            <div class='pull-right'>",h+="                <span class='k-dashboard-widget-commands'>",(o||s)&&(h+=this._renderItemCommands(i,o,e,u,s)),h+="                    <span class='k-dashboard-widget-command refresh fas fa-sync fa-fw' title='Refresh'><\/span>",h+="                <\/span>",h+="                <span class='k-dashboard-widget-command remove fas fa-times-circle fa-fw' title='Remove'><\/span>",h+="            <\/div>",h+="        <\/div>",h+="        <div class='k-dashboard-widget-body'>",h+="            <div class='k-state-normal'>",u&&u.template&&(h+=t.template(n("#"+u.template).html()||"")(e)),h+="            <\/div>",h+="            <div class='k-state-failed'>",h+=this.widgetFailedTemplate(e),h+="            <\/div>",h+="            <div class='k-state-misconfigured'>",h+=this.widgetMisconfiguredTemplate(e),h+="            <\/div>",f&&f.template&&(h+="        <div class='k-state-edit'>",h+="            <h3>Widget Options<\/h3>",h+=t.template(n("#"+f.template).html())(e),h+="        <\/div>"),h+="        <\/div>",h+="    <\/div>",h+="<\/div>",t.template(h)(e)},_renderItemCommand:function(i){var u=this,r=n("<span class='k-dashboard-widget-command'><\/span>");return i.click&&r.attr("data-bind",t.format("click: {0}",i.click)),i.iconClass&&r.addClass(i.iconClass),i.title&&r.attr("title",i.title),r[0].outerHTML},_renderItemCommands:function(i,r,u,f,e){var s=this,o="";if(e){if(!f.template)throw t.format("Popout options are not supported for widget {0} with ajax content.",i);o+=s._renderItemCommand({title:"Popout",iconClass:"expand fas fa-expand-alt fa-fw"})}return n.each(r,function(n,t){o+=s._renderItemCommand(t,u)}),o},_renderAjax:function(i,r,u){var f=this,e=n(r).find(".k-dashboard-widget-body .k-state-normal"),o,s;return t.ui.progress(n(e),!0),o=n.Deferred(),s=n.get({url:u,cache:!1,success:function(t){f.template=t;var u=f.template,s=n(u);e.html(s);f.setWidgetState(i,"normal");o.resolve(r)}}),s.fail(function(r){t.ui.progress(n(e),!1);f.setWidgetState(i,"error",r.responseText)}),o.promise()},_widgetList:function(){var n=this.options;this.widgetList=n.widgetList||[]}});t.ui.plugin(l);n.fn.extend({Dashboard:function(n){this.kendoDashboard(n)}})}(window.kendo.jQuery,window.kendo);var ApiService=function(n){function i(i,u){return n.ajax({url:r(u.area,u.controller,u.action),method:i,cache:!1,contentType:"application/json",data:u.data!=undefined?JSON.stringify(u.data):undefined,beforeSend:function(n){typeof u.username!="undefined"&&n.setRequestHeader("x-accuaccount-username",u.username);typeof u.password!="undefined"&&n.setRequestHeader("x-accuaccount-password",u.password);t.requestStart&&t.requestStart.bind(t)()},complete:function(){t.requestEnd&&t.requestEnd.bind(t)()},success:function(n){typeof u.success!="undefined"&&u.success(n);typeof t.success!="undefined"&&t.success()},error:function(n){var i={statusCode:n.status,statusDescription:n.statusText,errorMessage:n.responseJSON!=null?n.responseJSON.ErrorMessage:"A general failure occurred communicating with the server (status: "+n.statusText+").",response:n};typeof u.error!="undefined"&&u.error(i);typeof t.error!="undefined"&&t.error(i)}})}function r(n,t,i){var r="";return n===null?r+="api/":n===""||(r+="api/"),r+=t,i&&(r+="/",r+=i),r}var t={authorizationHeader:undefined,error:undefined,get:undefined,post:undefined,success:undefined,requestStart:undefined,requestEnd:undefined};return t.delete=function(n){return i("DELETE",n)},t.get=function(n){return i("GET",n)},t.patch=function(n){return i("PATCH",n)},t.post=function(n){return i("POST",n)},t.put=function(n){return i("PUT",n)},t},ErrorHandler=kendo.Class.extend({init:function(){},error:function(n){console.log(n.errorMessage)},success:function(){},warning:function(){}}),NotificationErrorHandler=function(n,t){return ErrorHandler.extend({element:t,notification:t,init:function(t){var i,r;ErrorHandler.fn.init.call(this);i=n(t);this.element=i;i.addClass("notification-error-handler");r=n("<div><\/div>").kendoNotification({appendTo:i,autoHideAfter:0,button:!0,hideOnClick:!1});this.notification=r.data("kendoNotification");r.appendTo(i)},clear:function(){var n=this.notification.getNotifications();n.fadeOut(500,function(){n.remove()})},error:function(n){ErrorHandler.fn.error.call(this,n);this.notification.error(n)},success:function(n){ErrorHandler.fn.success.call(this);this.notification.success(n)},warning:function(n){ErrorHandler.fn.warning.call(this);this.notification.warning(n)}})}(window.kendo.jQuery),ReportService=function(){return kendo.Class.extend({init:function(n){this.api=n},api:undefined,copyReport:function(n,t,i,r){return this.api.post({controller:"DynamicReporting",action:"CopyReport",username:n,data:{Owner:t,ReportName:i,NewReportName:r}})},createReport:function(n,t,i,r){return this.api.post({controller:"DynamicReporting",action:"CreateReport",username:n,data:{Template:t,User:n,Name:i,Description:r}})},deleteReport:function(n,t){return this.api.post({controller:"DynamicReporting",action:"DeleteReport",username:n,data:{Name:t}})},emailReport:function(n,t,i,r){return this.api.post({controller:"DynamicReporting",action:"EmailReport",username:n,data:{User:n,ReportName:t,Users:r,Message:i}})},getData:function(n,t,i,r,u){return this.api.post({controller:"DynamicReporting",action:"GetReportData",username:n,data:{Fields:i,Skip:u.skip,Take:u.take,User:n,ReportName:t,Filters:r}})},getReportTemplate:function(n,t){return this.api.post({controller:"DynamicReporting",action:"GetReportTemplate",username:n,data:{User:n,ReportName:t}})},getReportDefinition:function(n,t){return this.api.post({controller:"DynamicReporting",action:"GetReportDefinition",username:n,data:{User:n,ReportName:t}})},getReportFilterData:function(n,t,i){return this.api.post({controller:"DynamicReporting",action:"GetReportFilterData",data:{User:n,ReportName:t,FieldName:i}})},getReportTemplates:function(n){return this.api.get({controller:"DynamicReporting",action:"GetTemplates",username:n})},getReportList:function(n){return this.api.get({controller:"DynamicReporting",action:"GetUserReportList",username:n})},getSharedUsers:function(n,t){return this.api.post({controller:"DynamicReporting",action:"GetSharedUsers",data:{UserName:n,ReportName:t}})},getUsers:function(n){return this.api.post({controller:"DynamicReporting",action:"GetUsers",data:{UserName:n}})},getUserPermissions:function(n){return this.api.get({controller:"DynamicReporting",action:"GetUserPermissions",username:n})},shareReport:function(n,t,i,r){return this.api.post({controller:"DynamicReporting",action:"ShareReport",data:{ReportName:t,IsShared:i,Users:r},username:n})},updateReport:function(n,t,i,r,u,f,e){return this.api.post({controller:"DynamicReporting",action:"UpdateReport",username:n,data:{ReportName:t,NewReportName:i,Description:r,Fields:u,Groups:f,Filters:e}})}})}(),DateRangeFilterViewModel=function(n,t){return ViewModel.extend({init:function(n,t){ViewModel.fn.init.call(this);this.field=t;this.name=n;this.type="DateRange"},field:t,fromDate:null,toDate:null,type:t,filterType:0,isRelative:function(){return this.get("filterType")==1},isDate:function(){return this.get("filterType")==0},name:t,relativeValue:null,relativeType:0})}(window.kendo.jQuery),FilterSerializer=function(){return kendo.Class.extend({init:function(n){this.serialize(n)},serialize:function(n){var t={SearchFilters:[],MultiFilters:[],DateFilters:[],DateRangeFilters:[]};return $.each(n,function(n,i){var u,f,r;switch(i.type){case"DateRange":u={Field:i.field,FromDate:i.fromDate,ToDate:i.toDate,FilterType:i.filterType,RelativeType:i.relativeType,RelativeValue:i.relativeValue};t.DateRangeFilters.push(u);break;case"Search":f={Field:i.field,Operator:i.operator,Value:i.value};t.SearchFilters.push(f);break;case"Multi":r={Field:i.field,Values:[]};$.each(i.items,function(n,t){typeof MultiFilterEditViewModel!="undefined"&&i instanceof MultiFilterEditViewModel?t.isSelected===!0&&r.Values.push(t.value):i instanceof MultiFilterViewModel&&r.Values.push(t.value)});t.MultiFilters.push(r)}}),t}})}(),MultiFilterViewModel=function(n,t){return ViewModel.extend({init:function(n,t){ViewModel.fn.init.call(this);this.name=n;this.field=t},add:function(n){this.items.push(kendo.observable({value:n}))},field:t,items:[],name:t,type:"Multi"})}(window.kendo.jQuery),ReportField=kendo.Class.extend({init:function(n,t,i,r){this.name=n;this.sortOrder=t;this.sortDirection=i;this.width=Math.floor(r);this.behaviors={linkBehavior:null}},name:undefined,sortOrder:undefined,sortDirection:undefined,width:undefined,behaviors:undefined}),ReportGroup=function(){return kendo.Class.extend({init:function(n,t){this.name=n;this.sortDirection=t},name:undefined,sortDirection:undefined})}(),ReportTemplateFieldBehaviorViewModel=function(){return ViewModel.extend({init:function(){ViewModel.fn.init.call(this)},isAvailable:!1,isEnabled:!1,isSupported:!1})}(window.kendo.jQuery),ReportTemplateFieldViewModel=function(n,t){return ViewModel.extend({init:function(n,t,i,r){ViewModel.fn.init.call(this);this.group=n;this.name=t;this.label=i;this.type=r;this.set("behaviors",new kendo.data.ObservableObject({linkBehavior:new ReportTemplateFieldBehaviorViewModel}));this.bind("change",this._change)},group:t,name:t,label:t,type:t,checked:t,behaviors:t,_change:function(n){n.field==="checked"&&this.behaviors.linkBehavior.set("isAvailable",this.checked===!0&&this.behaviors.linkBehavior.isSupported===!0)}})}(window.kendo.jQuery),ReportTemplateGroupViewModel=function(n,t){return ViewModel.extend({init:function(n){ViewModel.fn.init.call(this);this.name=n;this.fields=[]},name:t,fields:t})}(window.kendo.jQuery),ReportTemplateViewModel=function(n,t){return ViewModel.extend({init:function(n,t,i){ViewModel.fn.init.call(this);this.name=n;this.description=t;this.isPurchased=i},name:t,description:t,isPurchased:t})}(window.kendo.jQuery),ReportViewModel=function(n,t){return ViewModel.extend({init:function(n){ViewModel.fn.init.call(this);this._service=n;this._canRead=!0},behaviors:new kendo.data.ObservableArray([]),columns:[],data:t,filters:[],isLicensed:!0,name:t,owner:t,pageSize:25,template:t,view:function(t,i){var r=this;return r.set("owner",t),r.set("name",i),n.when(r._service.getReportTemplate(t,i),r._service.getReportDefinition(t,i)).then(function(t,i){return n.proxy(r._initialize,r,t[0],i[0])()})},_createColumn:function(n,t){var r=this,i=new kendo.data.ObservableGridColumn(t.name);return t.behaviors.linkBehavior.isSupported&&t.behaviors.linkBehavior.isEnabled&&i.set("field",t.name+".Value"),i.title=r._getFieldLabel(n,t),i.hidden=!1,i.format=r._getColumnFormat(t),i.template=r._getColumnTemplate(t),i},_data:function(t,i,r,u){var f=this,e={};return n.each(t,function(t,i){n.each(i.fields,function(n,t){e[t.name]={type:f._getFieldType(t)}})}),new kendo.data.DataSource({transport:{read:function(t){n.proxy(f._read,f)(t)}},schema:{data:"Data",total:"Total",model:{fields:e}},pageSize:u,serverGrouping:!1,serverPaging:!0,serverFiltering:!0,serverSorting:!0,sort:r,group:i})},_getColumnName:function(n){return n.indexOf(".")>-1?n.substr(0,n.indexOf(".")):n},_getColumn:function(t){var i,r=this;return n.each(this.columns,function(n,u){return r._getColumnName(u.field)===r._getColumnName(t)?(i=u,!1):!0}),i},_getColumnFormat:function(n){switch(n.type){case"DateTime":return"{0:MM/dd/yyyy hh:mm:ss tt}";case"Money":return"{0:c2}";default:return t}},_getColumns:function(t,i){var f=this,r=[],u=[];return n.each(t,function(t,i){n.each(i.fields,function(n,t){u.push(t)})}),n.each(i,function(i,e){n.each(u,function(n,u){if(e.name===u.name){var o=f._createColumn(t,u);return o.width=e.width,r.splice(i,0,o),!1}})}),r},_getColumnTemplate:function(n){if(n.behaviors.linkBehavior.isSupported)return n.behaviors.linkBehavior.isEnabled?"<a href='#= "+n.name+".Link #'><span data-bind='text: "+n.name+".Value'><\/span><\/a>":t;switch(n.type){case"True/False":return"#= "+n.name+' == true ? "Y" : "N"#';default:return t}},_getDateRangeFilters:function(t,i){var r=this,u=[];return n.each(i,function(n,i){var e=r._getTemplateField(t,i.Field),o=r._getFieldLabel(t,e),f=new DateRangeFilterViewModel(o,i.Field);f.set("fromDate",i.FromDate);f.set("toDate",i.ToDate);f.set("filterType",i.FilterType);f.set("relativeType",i.RelativeType);f.set("relativeValue",i.RelativeValue);u.push(f)}),u},_getFields:function(t){var i=[];return n.each(t,function(n,t){var r=new ReportField(t.Name,t.SortOrder,t.SortDirection,t.Width);r.behaviors.linkBehavior=t.Behaviors.LinkBehavior;i.push(r)}),i},_getFieldType:function(n){if(n.behaviors.linkBehavior.isSupported&&n.behaviors.linkBehavior.isEnabled)return"object";switch(n.type){case"True/False":return"boolean";case"DateTime":return"date";case"Money":return"number";case"Number":return"number";default:return"string"}},_getFilters:function(n,t){var i=this._getSearchFilters(n,t.SearchFilters),r=this._getDateRangeFilters(n,t.DateRangeFilters),u=this._getMultiFilters(n,t.MultiFilters);return[].concat.apply([],[i,r,u])},_getFieldLabel:function(t,i){var r=i.label;return n.each(t,function(t,u){n.each(u.fields,function(n,t){i.group!==u.name&&i.label===t.label&&(r=i.label+" ("+i.group+")")})}),r},_getGroups:function(t){var i=[];return n.each(t,function(n,t){i.push({field:t.Name,dir:t.SortDirection===1?"desc":"asc"})}),i},_getMultiFilterPromise:function(t,i){return n.each(t,function(t,r){r.Field===i.field&&n.each(r.Values,function(n,t){i.add(t)})}),(new n.Deferred).resolve()},_getMultiFilters:function(t,i){var r=this,u=[];return n.each(i,function(n,i){var f=r._getTemplateField(t,i.Field),e=r._getFieldLabel(r.template,f),o=new MultiFilterViewModel(e,f.name);u.push(o)}),u},_getSearchFilters:function(t,i){var r=this,u=[];return n.each(i,function(n,i){var e=r._getTemplateField(t,i.Field),o=r._getFieldLabel(t,e),f=new SearchFilterViewModel(o,i.Field,e.type);f.set("operator",i.Operator);f.set("value",i.Value);u.push(f)}),u},_getSortDescriptions:function(t,i){var r=[],u=this,f=i.sort(function(n,t){return n.sortOrder<t.sortOrder?-1:n.sortOrder>t.sortOrder?1:0});return n.each(f,function(n,i){if(i.sortOrder!==-1){var f=u._getTemplateField(t,i.name),e;e=f.behaviors.linkBehavior.isSupported===!0&&f.behaviors.linkBehavior.isEnabled?kendo.format("{0}.Value",i.name):i.name;r.push({field:e,dir:i.sortDirection===1?"desc":"asc"})}}),r},_getSortDirection:function(n){switch(n){case 0:return"asc";case 1:return"desc";default:return"asc"}},_getSortDirectionInt:function(n){switch(n){case"asc":return 0;case"desc":return 1;default:return-1}},_getTemplate:function(t,i){var r=[];return n.each(t,function(t,u){var f=new ReportTemplateGroupViewModel(u.Name);n.each(u.Fields,function(t,r){var u=new ReportTemplateFieldViewModel(f.name,r.Name,r.Label,r.Type);u.behaviors.linkBehavior.set("isSupported",r.Behaviors.LinkBehavior);n.each(i,function(n,t){t.name===r.Name&&(u.set("checked",!0),u.behaviors.linkBehavior.isSupported===!0&&t.behaviors.linkBehavior!==null?u.behaviors.linkBehavior.set("isEnabled",!0):u.behaviors.linkBehavior.set("isEnabled",!1))});f.fields.push(u)});r.push(f)}),r},_getTemplateField:function(t,i){var r;return n.each(t,function(t,u){return n.each(u.fields,function(n,t){if(t.name===i)return r=t,!1}),r?!1:void 0}),r},_initialize:function(t,i){var r=this,s=r._getGroups(i.Groups),f=r._getFields(i.Fields),u=r._getTemplate(t.Groups,f),h=new kendo.data.ObservableArray(r._getColumns(u,f)),c=r._getSortDescriptions(u,f),e,o;return r.set("template",u),r.set("data",this._data(u,s,c,r.pageSize)),r.set("columns",h),r.set("filters",r._getFilters(r.template,i.Filters)),r.set("isLicensed",t.IsLicensed),e=[],n.each(r.filters,function(n,t){t.type==="Multi"&&e.push(r._getMultiFilterPromise(i.Filters.MultiFilters,t))}),o=new n.Deferred,n.when.apply(n,e).then(function(){o.resolve()}),o},_read:function(n){if(this._canRead===!1)return n.success([]);var t=this,r=new FilterSerializer,u=r.serialize(t.filters),f=t._serializeColumns(t.columns,n.data.sort),i=t._service.getData(t.owner,t.name,f,u,n.data);i.fail(function(t){n.error(t)});i.done(function(t){n.success(t)})},_serializeBehaviors:function(n){var t={linkBehavior:null};return n.behaviors.linkBehavior.isSupported===!0&&n.behaviors.linkBehavior.isEnabled===!0&&(t.linkBehavior={}),t},_serializeColumns:function(t,i){var u=[],r=this,f;return n.each(t,function(t,i){var f=new ReportField(i.field,-1,-1,i.width);n.each(r.template,function(t,u){n.each(u.fields,function(n,t){var u=r._getColumnName(i.field);t.name===u&&t.behaviors.linkBehavior.isSupported===!0&&t.behaviors.linkBehavior.isEnabled===!0&&(f.name=u,f.behaviors=r._serializeBehaviors(t))})});u.push(f)}),f=0,n.each(i,function(t,i){return n.each(u,function(n,t){var u=r._getColumnName(i.field);if(u===t.name){switch(i.dir){case"asc":t.sortDirection=0;break;case"desc":t.sortDirection=1}return t.sortOrder=++f,!1}return!0}),!0}),u},_service:t})}(window.kendo.jQuery),SearchFilterViewModel=function(n,t){return ViewModel.extend({init:function(n,t,i){ViewModel.fn.init.call(this);this.field=t;this.fieldType=i;this.name=n;this.value=this.getDefaultValue(i);this.operators=this.getOperators(i);this.operator=this.getDefaultOperator(i)},field:t,fieldType:t,getDefaultOperator:function(n){switch(n){case"Text":return"Contains";default:return"="}},getDefaultValue:function(n){switch(n){case"True/False":return"True";default:return null}},getOperators:function(n){switch(n){case"True/False":return["="];case"Text":return["Starts With","Contains","Ends With","="];default:return["<","<=","=",">",">="]}},name:t,operator:t,operators:t,type:"Search",value:t})}(window.kendo.jQuery);Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(n){var i,u,f,t,r;if(this==null)throw new TypeError('"this" is null or not defined');if(i=Object(this),u=i.length>>>0,typeof n!="function")throw new TypeError("predicate must be a function");for(f=arguments[1],t=0;t<u;){if(r=i[t],n.call(f,r,t,i))return r;t++}return undefined},configurable:!0,writable:!0});var DashboardService=kendo.Class.extend({init:function(n){this._webapi=n},getDashboard:function(n){return this._webapi.get({area:"",controller:kendo.format("dashboards({0})",n),action:"widgets"})},deleteDashboard:function(n){return this._webapi.delete({area:"",controller:kendo.format("dashboards({0})",n),action:""})},getDashboards:function(n){return this._webapi.get({area:"",controller:"dashboards",action:kendo.format("?username={0}",n)})},createDashboard:function(n,t,i){return this._webapi.post({area:"",controller:"dashboards",action:"",data:this._serializeDashboard(n,t,i)})},updateDashboard:function(n,t,i,r){return this._webapi.put({area:"",controller:kendo.format("dashboards({0})",r),action:"",data:this._serializeDashboard(n,t,i,r)})},_serializeDashboard:function(n,t,i,r){var u=[];return $.each(i,function(n,t){u.push({Id:t.id,Widget:t.widget,PositionX:t.positionX,PositionY:t.positionY,SizeX:t.sizeX,SizeY:t.sizeY,Options:t.options})}),{DashboardId:r,UserName:n,Name:t,Widgets:u}}}),DashboardManagerViewModel=ViewModel.extend({init:function(n,t,i,r,u,f,e,o){ViewModel.fn.init.call(this);this.$=n;this.kendo=t;this._webapi=i;this._service=r;this._reportService=u;this._errorHandler=f;this.user=e;this.userId=o;this.bind("change",this._change)},addDashboard:function(){var n=new DashboardViewModel("New Dashboard");n.set("_isNew",!0);this.widgets.data([]);this.dashboards.add(n);this._triggerDashboardsChange();this._changeDashboard(n);this.editDashboard()},addDashboardWidget:function(n){var t=new DashboardWidgetViewModelFactory,i=t.create(this.dashboard,this.currentDashboard.id,n.data.name,1,1,null,null,this.user,this.userId,null,this._reportService);this.canAddDashboardWidget()&&this.dashboard.addWidget(i)},canAddDashboard:function(){return!this.get("isEditingDashboard")},canAddDashboardWidget:function(){return this.dashboard.nextPosition(1,1)!==!1},canDeleteDashboard:function(){return!this.get("currentDashboard")||this.dashboards.view().length===1||this.get("currentDashboard._isNew")||this.get("isEditingDashboard")?!1:!0},canEditDashboard:function(){return this.get("currentDashboard")&&!this.get("isEditingDashboard")},canRefreshDashboard:function(){return!this.get("isEditingDashboard")},cancelEditDashboard:function(){var n=this,t=n.get("currentDashboard");t.setName(t.name);t.get("_isNew")&&n.removeDashboard(t);n._errorHandler.clear();n._endEditDashboard();n.currentDashboard?n._refreshDashboard(n.currentDashboard.id):n.dashboards.view().length>0&&n._changeDashboard(n.dashboards.view()[0])},currentDashboard:null,currentDashboardChanged:function(n){if(this._errorHandler.clear(),!this.currentDashboard){n.sender.select(-1);return}this._refreshDashboard(this.currentDashboard.id)},dashboard:null,dashboards:new kendo.data.DataSource({data:[]}),deleteDashboard:function(){var n=this;n.currentDashboard&&kendo.confirm("Are you sure you want to delete your current dashboard?").then(function(){var t=n._service.deleteDashboard(n.currentDashboard.id);t.done(function(){n.widgets.data([]);n.removeDashboard(n.currentDashboard);n.dashboards.view().length>0&&n._changeDashboard(n.dashboards.view()[0])})})},editDashboard:function(){this.set("isEditingDashboard",!this.isEditingDashboard);this.dashboard.edit();this.trigger("edit");this.trigger("change",{field:"canAddDashboardWidget"})},hasDashboards:function(){var n=this.get("dashboards"),t=n.data();return t.length>0},isEditingDashboard:!1,open:function(n){var t=this,i;if(t.widgets.data([]),n.Dashboards.length===0){t._createFirstDashboard();return}i=t._getDashboardsFromResponse(n);t.dashboards.data(i.items);i.default&&(t._changeDashboard(i.default),t._triggerDashboardsChange());!i.default&&i.items.length>0&&(t._changeDashboard(i.items[0]),t._triggerDashboardsChange())},refreshDashboard:function(){this._refreshDashboard(this.currentDashboard.id)},removeDashboard:function(n){this.widgets.data([]);this.currentDashboard.name===n.name&&this._changeDashboard(null);this.dashboards.remove(n);this._triggerDashboardsChange()},saveDashboard:function(){var n=this,t=null;n.dashboard.save();t=n.currentDashboard._isNew?n._service.createDashboard(n.user,n.currentDashboard.currentName,n.widgets.data()):n._service.updateDashboard(n.user,n.currentDashboard.currentName,n.widgets.data(),n.currentDashboard.id);t.done(function(t){n._updateDashboardState(n.currentDashboard,t,n.widgets.data());n._endEditDashboard()})},user:null,widgets:new kendo.data.DataSource({data:[]}),_change:function(n){var t=this;n.field==="dashboard"&&t.dashboard&&t.dashboard.bind("change",function(){t.trigger("change",{field:"canAddDashboardWidget"})})},_changeDashboard:function(n){this.set("currentDashboard",n);this.trigger("dashboardchange")},_createFirstDashboard:function(){var n=this,t=n._createWelcomeDashboard();t.done(function(t){n.dashboards.data([new DashboardViewModel("Welcome",t.DashboardId)]);n._changeDashboard(n.dashboards.view()[0]);n._triggerDashboardsChange()})},_createWelcomeDashboard:function(){return this._service.createDashboard(this.user,{name:"Welcome",currentName:"Welcome"}.name,[{widget:"Quick Search",positionX:1,positionY:1,sizeX:2,sizeY:8,options:null}])},_endEditDashboard:function(){this.set("isEditingDashboard",!1);this.dashboard.endEdit();this._errorHandler.clear();this.trigger("editend")},_getDashboardsFromResponse:function(n){var t,i=[];return $.each(n.Dashboards,function(r,u){var f=new DashboardViewModel(u.Name,u.Id);i.push(f);u.Name===n.Default&&(t=f)}),{items:i,"default":t}},_refreshDashboard:function(n){var t=this,i;if(t.currentDashboard._isNew){t.widgets.data([]);return}i=t._service.getDashboard(n);i.done(function(i){var r=[];$.each(i.Widgets,function(i,u){var e=new DashboardWidgetViewModelFactory,f=e.create(t.dashboard,n,u.Widget,u.PositionX,u.PositionY,u.SizeX,u.SizeY,t.user,t.userId,u.Options,t._reportService);f.set("id",u.Id);r.push(f)});t.widgets.data(r)})},_triggerDashboardsChange:function(){this.trigger("change",{field:"dashboards"})},_updateDashboardState:function(n,t,i){n.setName(n.currentName);n.set("id",t.DashboardId);n._isNew&&n.set("_isNew",!1);$.each(t.Widgets,function(n,t){$.each(i,function(n,i){t.PositionX===i.positionX&&t.PositionY===i.positionY&&i.set("id",t.Id)})})}}),DashboardView=View.extend({init:function(n,t,i,r,u){View.fn.init.call(this,n,t);this._webapi=i;this._service=r;this._errorHandler=u},ready:function(n,t){var i=this,r;i._errorHandling(i._webapi,i._errorHandler);r=i._service.getDashboards(t.user);r.done(function(r){$(".init-hidden").removeClass("init-hidden");View.fn.ready.call(i,n,t);i._ui(n,t);i._events(t);t.open(r)})},_closeDropDowns:function(n){var t=$(n.item).find("*[data-role='dropdownlist']").data("kendoDropDownList");t&&t.close()},_dashboardChange:function(){var n=$("#dashboard-dropdownlist").data("kendoDropDownList");n.trigger("change")},_drag:function(n){this._closeDropDowns(n)},_edit:function(){$("#name-input").css("display","flex");$("#name-input input[type='text']").focus();$("#name-input input[type='text']").select()},_editEnd:function(){document.getSelection().removeAllRanges()},_errorHandling:function(n,t){n.error=function(n){t.clear();t.error(n.errorMessage)}},_events:function(n){n.bind("dashboardchange",this._dashboardChange);n.bind("edit",this._edit);n.bind("editend",this._editEnd);n.dashboard.bind("change",$.proxy(this._change,this));n.dashboard.bind("popoutOpen",this._popoutOpen);n.dashboard.bind("popoutClose",this._popoutClose);$("#name-input input").on("keyup",$.proxy(this._nameInputKeyUp,this))},_change:function(n){(n.action==="resize"||n.action==="drag")&&this._closeDropDowns(n)},_nameInputKeyUp:function(n){switch(n.keyCode){case 13:this.viewModel.saveDashboard();break;case 27:this.viewModel.cancelEditDashboard()}},_popoutClose:function(n){n.modal||$("#dashboard-container").show()},_popoutOpen:function(n){n.modal||$("#dashboard-container").hide()},_ui:function(n,t){var i=$("#dashboard").data("kendoDashboard");t.set("dashboard",i);n.kendoTooltip({filter:"a[title]:not(a[title='']), span[title]:not(span[title=''])",position:"top"})}}),DashboardViewModel=ViewModel.extend({init:function(n,t){ViewModel.fn.init.call(this);this.setName(n);t&&this.set("id",t)},id:null,name:null,currentName:null,_isNew:!1,setName:function(n){this.set("name",n);this.set("currentName",n)}}),DashboardWidgetViewModel=ViewModel.extend({init:function(n,t,i,r,u,f,e,o){ViewModel.fn.init.call(this);this.dashboard=n;this.set("widget",t);this.set("positionX",i);this.set("positionY",r);this.set("sizeX",u);this.set("sizeY",f);this.set("id",e);this.set("options",o)},widget:undefined,positionX:undefined,positionY:undefined,sizeX:undefined,sizeY:undefined,id:undefined,refresh:function(){},options:[],getOption:function(n){var t=null;return $.each(this.options,function(i,r){r.Name===n&&(t=r)}),t},setOption:function(n,t){$.each(this.options,function(i,r){r.Name===n&&(r.Value=t)})}}),DashboardWidgetViewModelFactory=kendo.Class.extend({create:function(n,t,i,r,u,f,e,o,s,h,c){switch(i){case"Active Tasks":return new ActiveTasksDashboardWidgetViewModel(n,i,r,u,f,e);case"My Active Exceptions Summary":return new ExceptionDashboardWidgetViewModel(n,i,r,u,f,e);case"Quick Search":return new QuickSearchDashboardWidgetViewModel(n,i,r,u,f,e);case"My Uploads":return new MyUploadsWidgetViewModel(n,i,r,u,f,e,null,o,s,h,t);case"Report":return new ReportWidgetViewModel(n,i,r,u,f,e,null,o,h,c);default:return new DashboardWidgetViewModel(n,i,r,u,f,e)}}}),ExceptionDashboardWidgetViewModel=DashboardWidgetViewModel.extend({init:function(n,t,i,r,u,f,e){DashboardWidgetViewModel.fn.init.call(this,n,t,i,r,u,f,e)},openFilterSettings:function(){var n=this;$.ajax({url:"activeexceptionfilter.asp",cache:!1,success:function(t){var i=new ExceptionFilterSettingsView(n,t);i.open()},error:function(n){console.log(n)}})},updateSettings:function(n,t){var i=this;$.ajax({type:"POST",url:"activeexceptionfilterupdate.asp",cache:!1,data:t,success:function(){n();i.dashboard.refreshWidget(i)},error:function(n){console.log(n)}})}}),ActiveTasksDashboardWidgetViewModel=ExceptionDashboardWidgetViewModel.extend({init:function(n,t,i,r,u,f,e){ExceptionDashboardWidgetViewModel.fn.init.call(this,n,t,i,r,u,f,e)},resolveTask:function(n){var t=this,i=$(n.currentTarget).attr("data-exceptionId");$.ajax({url:kendo.format("resolvetask.asp?exceptionId={0}&section=dashboard",i),cache:!1,success:function(){t.dashboard.refreshWidget(t)},error:function(n){console.log(n)}})},reassignTask:function(n){var t=this,i=$(n.currentTarget).attr("data-exceptionId");$.ajax({url:kendo.format("reassigntaskInclude.asp?exceptionId={0}",i),cache:!1,success:function(n){var i=new ActiveTasksDashboardWidgetView(t,n);i.open()},error:function(n){console.log(n)}})},updateTask:function(n,t){var i=this;$.ajax({type:"POST",url:"reassigntaskupdate.asp",cache:!1,data:t,success:function(){n();i.dashboard.refreshWidget(i)},error:function(n){console.log(n)}})}}),ActiveTasksDashboardWidgetView=function(n,t){var i=$(t),u=i.find("#reassign-user-form"),f=i.find("#page-title").val(),r=$("<div class='aa-active-task-dashboard-widget'><\/div>").kendoDialog({title:f,closable:!1,modal:!0,content:i,actions:[{text:"Update",primary:!0,action:function(){var t=u.serialize();n.updateTask($.proxy(r.close,r),t)}},{text:"Cancel"}],open:function(){$("#assigned-user-id").kendoDropDownList()},close:function(){this.destroy()}}).data("kendoDialog");return r},ExceptionFilterSettingsView=function(n,t){var r=$(t),u=r.find("#active-exception-filter-form"),i=$("<div class='aa-active-exception-filter'><\/div>").kendoDialog({width:"700px",title:"Exception Filter Settings",closable:!1,modal:!0,content:r,actions:[{text:"Update",primary:!0,action:function(){var t=u.serialize();n.updateSettings($.proxy(i.close,i),t)}},{text:"Cancel"}],close:function(){this.destroy()}}).data("kendoDialog");return i},QuickSearchDashboardWidgetViewModel=DashboardWidgetViewModel.extend({init:function(n,t,i,r,u,f,e){DashboardWidgetViewModel.fn.init.call(this,n,t,i,r,u,f,e)},customerNames:new kendo.data.DataSource({serverFiltering:!0,transport:{read:{url:"kendoQuickSearch.asp?table=customer&key=customerName&val=customerName",type:"get",dataType:"json",contentType:"application/json",cache:!1}},schema:{data:"results",model:{fields:{Value1:{type:"string"}}}}}),customerNumbers:new kendo.data.DataSource({serverFiltering:!0,transport:{read:{url:"kendoQuickSearch.asp?table=customer&key=customerNumber&val=customerNumber",type:"get",dataType:"json",contentType:"application/json",cache:!1}},schema:{data:"results",model:{fields:{Value1:{type:"string"}}}}}),taxIds:new kendo.data.DataSource({serverFiltering:!0,transport:{read:{url:"kendoQuickSearch.asp?table=customer&key=taxid&val=taxid",type:"get",dataType:"json",contentType:"application/json",cache:!1}},schema:{data:"results",model:{fields:{Value1:{type:"string"}}}}}),accountNumbers:new kendo.data.DataSource({serverFiltering:!0,transport:{read:{url:"kendoQuickSearch.asp?table=loan&key=loanNumber&val=loanNumber",type:"get",dataType:"json",contentType:"application/json",cache:!1}},schema:{data:"results",model:{fields:{Value1:{type:"string"}}}}})}),MyUploadsItemViewModel=ViewModel.extend({init:function(n,t,i,r,u,f){ViewModel.fn.init.call(this);this._widget=n;this.name=t;this.type=i;this.link=r;this.size=u;this.createdDate=f},_widget:undefined,name:undefined,type:undefined,link:undefined,size:undefined,createdDate:undefined}),MyUploadsDirectoryViewModel=MyUploadsItemViewModel.extend({init:function(n,t,i,r){MyUploadsItemViewModel.fn.init.call(this,n,t,i,r)},open:function(){this._widget.openDirectory(this)}}),MyUploadsFileInfoModel=Model.extend({init:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){Model.fn.init.call(this);this.customerName=n;this.customerNumber=t;this.customerLink=i;this.account=r;this.accountType=u;this.accountLink=f;this.document=e;this.comment=o;this.expirationDate=s;this.uploadSource=h;this.uploadUser=c;this.fileClass=l;this.moveLink=a;this.documentGroup=v;this.documentTab=y;this.authorization=p},customerName:undefined,customerNumber:undefined,customerLink:undefined,account:undefined,accountType:undefined,accountLink:undefined,document:undefined,link:undefined,comment:undefined,expirationDate:undefined,uploadSource:undefined,uploadUser:undefined,fileClass:undefined,moveLink:undefined,documentGroup:undefined,documentTab:undefined,authorization:undefined}),MyUploadsFileInfoView=function(n){return $('<div id="document-info-window"><\/div>').kendoDialog({width:"700px",height:"430px",closable:!1,actions:[{text:"Close",primary:!0}],visible:!1,content:kendo.template($("#dashboard-myuploads-fingerprinting").html())(n),title:"Document Upload Details",modal:!0,close:function(){this.destroy()}}).data("kendoDialog")},MyUploadsFileViewModel=MyUploadsItemViewModel.extend({init:function(n,t,i,r,u,f,e,o){MyUploadsItemViewModel.fn.init.call(this,n,t,i,r,e,o);this._name=t;this._size=e;this.extension=u;this.info=f;this.set("name",this._getName);this.set("size",this._getSize())},_getName:function(){return this.info&&this.info.document?this.info.document:this._name},_getSize:function(){if(this._size){var n=Math.floor(Math.log(this._size)/Math.log(1024));return(this._size/Math.pow(1024,n)).toFixed(2)*1+" "+["bytes","KB","MB","GB","TB"][n]}return this._size},createdDate:undefined,extension:undefined,open:function(){var n=this;$.ajax({type:"HEAD",url:n.link,success:function(){var t=new MyUploadsFileView(n);t.center().open()},error:function(){var n=new MyUploadsFileNotFoundView(name);n.open()}})},info:undefined,hasInfo:function(){return this.get("info")},openInfo:function(){var n=this.get("info"),t=new MyUploadsFileInfoView(n);t.open()},beginMove:function(){var n=this;$.ajax({url:n.info.moveLink,cache:!1,success:function(t){var i=new MyUploadsFileMoveView(n,t);i.open()},error:function(t){var i=new MyUploadsFileNotMovedView(n.name());i.open();console.log(t.responseText)}})},endMove:function(n){var t=this,i=t._getUploadDirUrlParam(t.info.moveLink,"uploadDir");$.ajax({type:"POST",url:kendo.format("uploadquickmoveupdate.asp?uploadDir={0}",i),cache:!1,data:n,success:function(){t._refreshUploadWidgets()},error:function(n){var i=new MyUploadsFileNotMovedView(t.name());i.open();console.log(n.responseText)}})},_getUploadDirUrlParam:function(n,t){for(var i,u=n.split("&"),r=0;r<u.length;r++)if(i=u[r].split("="),i[0]===t)return i[1]===undefined?null:decodeURIComponent(i[1]);return null},_refreshUploadWidgets:function(){var n=this,t=n._widget.dashboard.dataSource.data();$.each(t,function(t,i){i.widget===n._widget.widget&&i.path===n._widget.path&&i.refresh()})}}),MyUploadsFileView=function(n){var t=$(window).width()*.85,i=$(window).height()*.85;return $("<div><\/div>").kendoWindow({title:n.info&&n.info.document?n.info.document:n.name(),content:kendo.format("{0}&dispositionType=inline",n.link),iframe:!0,width:t,height:i,modal:!0,actions:["Maximize","Close"]}).data("kendoWindow")},MyUploadsFileNotFoundView=function(n){return $("<div><\/div>").kendoDialog({title:kendo.format("{0} is unavailable",n),content:$("#dashboard-myuploads-fileerror").html(),width:"520px"}).data("kendoDialog")},MyUploadsFileNotMovedView=function(n){return $("<div><\/div>").kendoDialog({title:kendo.format("{0} failed to move",n),content:$("#dashboard-myuploads-moveerror").html(),width:"520px"}).data("kendoDialog")},MyUploadsWidgetViewModel=DashboardWidgetViewModel.extend({init:function(n,t,i,r,u,f,e,o,s,h,c){DashboardWidgetViewModel.fn.init.call(this,n,t,i,r,u,f,e,h);this.user=o;this.userId=s;this.dashboardId=c;h?this.set("options",h):this.set("options",[{Name:"Path",Value:null}]);this.items=this._dataSource(this)},_dataSource:function(n){var t=n,i=t.getOption("Path"),r=i&&i.Value!==null?i.Value:t.user,u=kendo.format("uploads/items?path={0}&userId={1}",r,t.userId);return new kendo.data.DataSource({transport:{read:{url:u,dataType:"json",cache:!1}},schema:{data:function(n){return t._getViewModels(n.Items)}},error:function(n){t.dashboard.setWidgetState(t,"error",n.xhr.responseText)},requestEnd:function(n){n.response&&(t.dashboard.setWidgetState(t,"normal"),t._onRequestEnd(n.response))}})},_getViewModels:function(n){var t=[],i=this;return $.each(n,function(n,r){switch(r.Type){case"folder":t.push(i._getDirectoryViewModel(r));break;case"file":t.push(i._getFileViewModel(r));break;default:throw"Item type is not known.";}}),t},_getDirectoryViewModel:function(n){return new MyUploadsDirectoryViewModel(this,n.Name,n.Type,n.Link)},_getFileViewModel:function(n){var t=null;return n.Info!==null&&(t=new MyUploadsFileInfoModel(n.Info.CustomerName,n.Info.CustomerNumber,n.Info.CustomerLink,n.Info.Account,n.Info.AccountType,n.Info.AccountLink,n.Info.Document,n.Info.Comment,n.Info.ExpirationDate,n.Info.UploadSource,n.Info.UploadUser,n.Info.FileClass,n.Info.MoveLink,n.Info.DocumentGroup,n.Info.DocumentTab,{canRead:n.Info.Authorization.CanRead,canUpload:n.Info.Authorization.CanUpload})),new MyUploadsFileViewModel(this,n.Name,n.Type,n.Link,n.Extension,t,n.Size,n.CreatedDate)},_onRequestEnd:function(n){this.set("path",n.Path);this.set("parent",n.Parent);this.id&&(this.setOption("Path",n.Path),$.post({url:kendo.format("dashboards({0})/widgets({1})",this.dashboardId,this.id),contentType:"application/json",data:JSON.stringify({Id:this.id,Widget:this.widget,PositionX:this.positionX,PositionY:this.positionY,SizeX:this.sizeX,SizeY:this.sizeY,Options:this.options})}))},dashboardId:null,openParentDirectory:function(){var n=this,t=n.get("parent");n.items.transport.options.read.url=kendo.format("{0}&userId={1}",t,n.userId);n.refresh()},openDirectory:function(n){var t=this;t.items.transport.options.read.url=kendo.format("{0}&userId={1}",n.link,t.userId);t.refresh()},path:undefined,hasParent:function(){return this.get("path")},items:undefined,parentDirectory:null,user:undefined,userId:undefined,refresh:function(){this.items.read()},options:[]}),MyUploadsFileMoveView=function(n,t){var i=$(t),r=i.find("#form-upload-quickmove"),u=$("<div><\/div>").kendoDialog({width:"700px",title:"Move Document",closable:!1,modal:!0,content:i,actions:[{text:"Update",primary:!0,action:function(){var t=r.serialize();n.endMove(t)}},{text:"Cancel"}],close:function(){this.destroy()}}).data("kendoDialog");return $("#target-value").kendoDropDownList(),u},ReportWidgetViewModel=function(n,t){return ReportViewModel.extend({init:function(n,t,i,r,u,f,e,o,s,h){ReportViewModel.fn.init.call(this,h);this.user=o;this._reportService=h;this.dashboard=n;this.set("widget",t);this.set("positionX",i);this.set("positionY",r);this.set("sizeX",u);this.set("sizeY",f);this.set("id",e);this.set("options",s);this.set("reports",this._reports());s?this.set("options",s):this.set("options",[{Name:"ReportName",Value:null},{Name:"ReportOwner",Value:null}])},widget:t,positionX:t,positionY:t,sizeX:t,sizeY:t,id:t,options:[],getOption:function(t){var i=null;return n.each(this.options,function(n,r){r.Name===t&&(i=r)}),i},setOption:function(t,i){n.each(this.options,function(n,r){r.Name===t&&(r.Value=i)})},hasReports:function(){var n=this.get("reports"),t=n.view();return t.length>0},isfiltered:function(){return this.get("filters").length>0},refresh:function(){var n=this;n.report&&n.view(n.report.owner,n.report.name)},refreshReports:function(){this.reports.read()},report:null,reports:t,reportChanged:function(){var n=this;n.report?(n.setOption("ReportName",n.report.name),n.setOption("ReportOwner",n.report.owner),n.dashboard.setWidgetState(n,"normal")):(n.setOption("ReportName",null),n.setOption("ReportOwner",null));n.report&&n.view(n.report.owner,n.report.name)},user:t,view:function(t,i){var r=this,u;r.dashboard.setWidgetState(r,"normal");u=ReportViewModel.fn.view.call(r,t,i);u.fail(n.proxy(r._viewFail,r));u.done(function(){r.data.fetch()})},_reports:function(){var t=this;return new kendo.data.DataSource({transport:{read:function(n){var i=t._reportService.getReportList(t.user);i.fail(function(t){n.error(t)});i.done(function(t){n.success(t)})}},change:function(){var i=t.getOption("ReportName").Value;i&&n.each(this.view(),function(n,r){r.name===i&&t.set("report",r)});t.report?t.view(t.report.owner,t.report.name):t.dashboard.setWidgetState(t,"misconfigured")},error:function(n){t.dashboard.setWidgetState(t,"error",n.xhr.responseText)},schema:{data:function(n){return t._reportItems(n)},type:"json",model:{id:"ReportId",fields:{name:{field:"Name"},owner:{field:"Owner"},isOwned:{field:"IsOwned",type:"boolean"}}}},sort:{field:"name",dir:"asc"}})},_reportItems:function(t){var i=[];return n.each(t.Items,function(n,t){i.push(t)}),n.each(t.SharedItems,function(n,t){i.push(t)}),i},_viewFail:function(n){n.responseJSON?this.dashboard.setWidgetState(this,"error",n.responseJSON):this.dashboard.setWidgetState(this,"error",n.responseText)}})}(window.kendo.jQuery),ActiveExceptionsFilter=function(n){var t={validateCheckboxes:undefined,enableDropdowns:undefined,disableSection:undefined,clearAll:undefined,checkAll:undefined,checkBank:undefined,checkItem:undefined,updateCheckList:undefined};return t.validateCheckboxes=function(){var u="",f=n.frmDisplayPrefs.hidFilterBy.value,t=n.frmDisplayPrefs,r=!1;if(f==0)r=!0;else if(f==1){for(i=0;i<t.chkOfficerId.length;i++)t.chkOfficerId[i].checked&&(r=!0);t.chkOfficerAll.checked&&(r=!0);t.chkOfficerBankId.checked&&(r=!0);u="Please select at least one officer."}else if(f==2){for(i=0;i<t.chkUserId.length;i++)t.chkUserId[i].checked&&(r=!0);t.chkUserAll.checked&&(r=!0);t.chkUserBankId.checked&&(r=!0);u="Please select at least one user."}r==!0?n.frmDisplayPrefs.submit():alert(u)},t.enableDropdowns=function(i){n.frmDisplayPrefs.hidFilterBy.value=i;i==1?(t.disableSection("chkOfficerAll","chkOfficerBank","chkOfficerItem",!1),t.disableSection("chkUserAll","chkUserBank","chkUserItem",!0),t.clearAll("chkUserAll","chkUserBank","chkUserItem")):i==2?(t.disableSection("chkOfficerAll","chkOfficerBank","chkOfficerItem",!0),t.clearAll("chkOfficerAll","chkOfficerBank","chkOfficerItem"),t.disableSection("chkUserAll","chkUserBank","chkUserItem",!1)):(t.disableSection("chkOfficerAll","chkOfficerBank","chkOfficerItem",!0),t.clearAll("chkOfficerAll","chkOfficerBank","chkOfficerItem"),t.disableSection("chkUserAll","chkUserBank","chkUserItem",!0),t.clearAll("chkUserAll","chkUserBank","chkUserItem"))},t.disableSection=function(t,i,r,u){for(obj=n.getElementById(t),obj.disabled=u,bankIdx=0,bankDone=!1;!bankDone;){if(bankObj=n.getElementById(i+"_"+bankIdx),bankObj==null)bankDone=!0;else for(bankObj.disabled=u,itemIdx=0,itemDone=!1;!itemDone;)itemObj=n.getElementById(r+"_"+bankIdx+"_"+itemIdx),itemObj==null?itemDone=!0:itemObj.disabled=u,itemIdx++;bankIdx++}return!0},t.clearAll=function(t,i,r){var c,f,u,e,o,s,h;for(c=n.getElementById(t),c.checked=!1,e=!1,u=0;!e;){if(f=n.getElementById(i+"_"+u),f==null)e=!0;else for(f.checked=!1,h=!1,s=0;!h;)o=n.getElementById(r+"_"+u+"_"+s),o==null?h=!0:o.checked=!1,s++;u++}},t.checkAll=function(t,i,r){var u,f,o,s,h,c,e,l=n.getElementById(t);for(f=0,c=!1,e=!1;!c;){if(u=i+"_"+f,s=n.getElementById(u),s==null)c=!0;else for(s.checked=l.checked,o=0,e=!1;!e;)u=r+"_"+f+"_"+o,h=n.getElementById(u),h==null?e=!0:h.checked=l.checked,o++;f++}},t.checkBank=function(i,r,u,f){for(var o,h=i.id.split("_")[1],e=0,s=!1;!s;)o=n.getElementById(f+"_"+h+"_"+e),o==null?s=!0:o.checked=i.checked,e++;t.updateCheckList(r,u,f)},t.checkItem=function(n,i,r){t.updateCheckList(n,i,r)},t.updateCheckList=function(t,i,r){for(var e,o,s,h,c,a=n.getElementById(t),l=!0,u=0,f=!1;!f;){if(e=n.getElementById(i+"_"+u),e==null)f=!0;else{for(o=!0,h=0,s=!1;!s;)c=n.getElementById(r+"_"+u+"_"+h),c==null?s=!0:c.checked||(o=!1,l=!1),h++;e.checked=o}u++}a.checked=l},t}(window.document);